jQuery(window).on('changed.am.section',function(e,section){if(AmCharts.Editor.current.section!='editor'){return;}
if(!jQuery(section).data('loaded')){AmCharts.Editor.log('info','load section editor');jQuery(section).load(AmCharts.Editor.CONSTANT.URL_BASE+'static/tpl/section-editor.tpl?'+ AmCharts.Editor.CONSTANT.RND_KEY,function(){jQuery(section).data('loaded',true);AmCharts.Editor.updateSection('editor');AmCharts.Editor.getUser();});}else if(jQuery.inArray('editor',AmCharts.Editor.current.rendered)==-1){AmCharts.Editor.log('info','process section editor');(function(){if(!AmCharts.ValueAxis.prototype.patched){var TMP=AmCharts.ValueAxis.prototype.draw;AmCharts.ValueAxis.prototype.patched=true;AmCharts.ValueAxis.prototype.draw=function(theme){if(this.minimumDate&&typeof this.minimumDate=="string"){this.minimumDate=AmCharts.stringToDate(this.minimumDate,this.chart.dataDateFormat||"YYYY-MM-DD");}
if(this.maximumDate&&typeof this.maximumDate=="string"){this.maximumDate=AmCharts.stringToDate(this.maximumDate,this.chart.dataDateFormat||"YYYY-MM-DD");}
TMP.apply(this,arguments);}}})();jQuery('.app-editor').layout({center__paneSelector:".app-editor-2",west__paneSelector:".app-editor-1",west__size:270,spacing_open:0,spacing_closed:0,center__childOptions:{center__paneSelector:".app-editor-2-2",center__minSize:300,west__paneSelector:".app-editor-2-1",west__size:440,west__minSize:300,spacing_open:12,spacing_closed:12,livePaneResizing:true,onresize_end:function(){jQuery(AmCharts.Editor.SELECTORS.table).handsontable('render');},center__childOptions:{center__paneSelector:".app-editor-2-2-1",south__paneSelector:".app-editor-2-2-2",south__size:"50%",south__minSize:39,spacing_open:12,spacing_closed:12,livePaneResizing:true,onresize_end:function(){jQuery(AmCharts.Editor.SELECTORS.table).handsontable('render');removeTooltips();}}}});function removeTooltips(){jQuery(".tooltip").animate({opacity:0},{duration:250,done:function(){jQuery(this).remove();}});}
jQuery(AmCharts.Editor.SELECTORS.table).handsontable({data:[],startRows:5,startCols:3,minSpareRows:0,stretchH:'all',colWidths:100,removeRowPlugin:true,colHeaders:function(col){var output="";var button=null;var fieldname=AmCharts.Editor.dataFields[col];var graph=AmCharts.Editor.getGraphByField(fieldname);if(jQuery.inArray(AmCharts.Editor.chartType,['serial','xy','radar'])!=-1){button=jQuery('<i></i>').attr('data-name',fieldname);button.addClass('am-data-assign-col am am-add');if(graph&&graph.itemColor!=='undefined'){button.css({color:graph.itemColor,backgroundColor:graph.itemColor}).addClass('selected');}
output+=jQuery('<div></div>').append(button).html();}
button=jQuery('<i></i>').attr('fieldname',fieldname);button.addClass('am-data-remove-col am am-remove');output+=jQuery('<div></div>').append(button).html();output+='<input class="am-data-input-col" type="text" value="'+ AmCharts.Editor.dataFields[col]+'">';return output;},afterChange:function(){AmCharts.Editor.changedData(AmCharts.Editor.dataProvider);},afterRemoveRow:function(){AmCharts.Editor.changedData(AmCharts.Editor.dataProvider);},afterRender:function(){this.rootElement.find('.am-data-input-col').each(function(col){jQuery(this).on('input',function(){var fieldname=AmCharts.Editor.dataFields[col];var graph=AmCharts.Editor.getGraphByField(fieldname);var value=this.value;clearTimeout(AmCharts.Editor.current.changeColTimer);AmCharts.Editor.current.changeColTimer=setTimeout(function(){AmCharts.Editor.changeColTitle(graph,fieldname,value);},750);}).on('focus',function(){jQuery(this).tooltip('hide').parent().parent().addClass('active');}).on('blur',function(){jQuery(this).parent().parent().removeClass('active');removeTooltips();}).tooltip({title:AmCharts.Editor.getMSG('tooltip_rename_col'),placement:'bottom',container:'body'});});this.rootElement.find('.am-data-assign-col').each(function(col){jQuery(this).on('click',function(){var fieldname=jQuery(this).data('name');var graph=AmCharts.Editor.getGraphByField(fieldname);if(jQuery(this).hasClass('selected')){AmCharts.Editor.openGraph(graph);}else{jQuery(AmCharts.Editor.SELECTORS.modal).data('tmp',{fieldname:fieldname});AmCharts.Editor.modal({remote:AmCharts.Editor.CONSTANT.URL_BASE+'static/tpl/modal-data-assign-col.tpl?'+ AmCharts.Editor.CONSTANT.RND_KEY});}}).tooltip({title:AmCharts.Editor.getMSG(jQuery(this).hasClass('selected')?'tooltip_edit_col':'tooltip_assign_col'),container:'body'});});this.rootElement.find('.am-data-remove-col').each(function(col){jQuery(this).on('click',function(){for(var i=0;i<AmCharts.Editor.dataProvider.length;i++){delete AmCharts.Editor.dataProvider[i][AmCharts.Editor.dataFields[col]];}
AmCharts.Editor.dataFields.splice(col,1);AmCharts.Editor.processData(AmCharts.Editor.dataProvider);removeTooltips();}).tooltip({title:AmCharts.Editor.getMSG('tooltip_remove_col'),container:'body'});});}});var betaTimer=0;var betaShow=false;jQuery('.navbar-header-title .beta').tooltip({title:"Yip beta ;)",placement:"bottom"});function betaToggle(){clearTimeout(betaTimer);betaTimer=setTimeout(function(){jQuery('.navbar-header-title .beta').tooltip(betaShow?'show':'hide');},250);}
jQuery('.navbar-header-title, .navbar-header-title span').off().on('mouseenter mouseleave',function(e){betaShow=e.type=='mouseenter';betaToggle();});jQuery('.navbar-header-title').off().on('click',function(e){e.preventDefault();jQuery.router.go('/');});jQuery('.app-section-editor .am-menu-save a').off().on('click',function(e){e.preventDefault();if(!jQuery(this).parent().is('.disabled')){AmCharts.Editor.modal({remote:AmCharts.Editor.CONSTANT.URL_BASE+'static/tpl/modal-chart-save.tpl?'+ AmCharts.Editor.CONSTANT.RND_KEY,});}});jQuery('.app-section-editor .am-menu-save-draft a').off().on('click',function(e){e.preventDefault();if(!jQuery(this).parent().is('.disabled')){AmCharts.Editor.modal({remote:AmCharts.Editor.CONSTANT.URL_BASE+'static/tpl/modal-chart-save-draft.tpl?'+ AmCharts.Editor.CONSTANT.RND_KEY,});}}).tooltip({title:AmCharts.Editor.getMSG('tooltip_save_draft'),placement:'bottom'});jQuery('.app-section-editor .am-menu-fork a').off().on('click',function(e){e.preventDefault();if(!jQuery(this).parent().is('.disabled')){AmCharts.Editor.modal({remote:AmCharts.Editor.CONSTANT.URL_BASE+'static/tpl/modal-chart-fork.tpl?'+ AmCharts.Editor.CONSTANT.RND_KEY,});}}).tooltip({title:AmCharts.Editor.getMSG('tooltip_fork_chart'),placement:'bottom'});jQuery('.app-section-editor .am-menu-new a').off().on('click',function(e){e.preventDefault();jQuery.router.go('/new/');});jQuery('.app-section-editor .am-menu-share a').off().on('click',function(e){e.preventDefault();if(!jQuery(this).parent().is('.disabled')){jQuery.router.go('/'+ AmCharts.Editor.current.chart.chart_id+'/');}});jQuery('.app-section-editor .am-menu-user, .app-section-editor .am-menu-signin').off().on('show.bs.dropdown hide.bs.dropdown',function(e){if(e.type=='show'){jQuery(document.body).addClass('modal-open');jQuery('<div class="modal-backdrop modal-backdrop-login fade"></div>').appendTo(document.body).one(jQuery.support.transition.end,function(){jQuery(this).addClass('in');}).emulateTransitionEnd(0);if(!jQuery('.app-section-editor .navbar-signin .dropdown-menu iframe').data('loaded')){jQuery('.app-section-editor .navbar-signin .dropdown-menu iframe').attr('src',AmCharts.Editor.CONSTANT.URL_AMCHARTS+'sign-in/editor/?redirect_to='+ location.protocol+ AmCharts.Editor.CONSTANT.URL_BASE+'auth/done/?'+ AmCharts.Editor.CONSTANT.RND_KEY).data('loaded',true);}}else{jQuery(document.body).removeClass('modal-open');jQuery('.modal-backdrop-login').removeClass('in').one(jQuery.support.transition.end,function(){jQuery(this).remove();}).emulateTransitionEnd(300);}});jQuery('.nav-tabs li a').off().on('shown.bs.tab',function(){jQuery(AmCharts.Editor.SELECTORS.table).handsontable('render');});jQuery(".am-data-add-row").off().on('click',function(e){e.preventDefault();jQuery(AmCharts.Editor.SELECTORS.table).handsontable('alter','insert_row');});jQuery(".am-data-add-col").off().on('click',function(e){e.preventDefault();AmCharts.Editor.modal({remote:AmCharts.Editor.CONSTANT.URL_BASE+'static/tpl/modal-data-add-col.tpl?'+ AmCharts.Editor.CONSTANT.RND_KEY});});jQuery(".am-data-import").off().on('click',function(e){e.preventDefault();AmCharts.Editor.modal({remote:AmCharts.Editor.CONSTANT.URL_BASE+'static/tpl/modal-data-import.tpl?'+ AmCharts.Editor.CONSTANT.RND_KEY});});jQuery(".app-section-editor").off('dragover').on('dragover',function(e){e.preventDefault();e.stopPropagation();AmCharts.Editor.modal({remote:AmCharts.Editor.CONSTANT.URL_BASE+'static/tpl/modal-data-import.tpl?'+ AmCharts.Editor.CONSTANT.RND_KEY});});jQuery('.am-editor-config').off().on('input',function(event){AmCharts.Editor.parseConfig(true);}).on('blur',function(){AmCharts.Editor.isEditing=false;AmCharts.Editor.parseConfig();});jQuery('.am-editor-themes li a').off().on('click',function(e){e.preventDefault();var theme=jQuery(this).parent().data('theme');jQuery('.am-editor-themes li').each(function(){jQuery(this)[theme==jQuery(this).data('theme')?'addClass':'removeClass']('active');});AmCharts.Editor.applyTheme(theme);AmCharts.Editor.current.css.backgroundColor=AmCharts.Editor.chart.backgroundColor;AmCharts.Editor.current.css.backgroundRGBA=AmCharts.Editor.hexToRgb(AmCharts.Editor.current.css.backgroundColor);try{AmCharts.Editor.chart["export"].defaults.fabric.backgroundColor=AmCharts.Editor.chart.backgroundColor;}catch(err){}
if(AmCharts.Editor.current.section=='share'){AmCharts.Editor.drawCSS();}}).tooltip({title:function(){return AmCharts.Editor.getMSG('tooltip_set_theme').replace('[[theme]]',jQuery(this).parent().data('theme'));}});jQuery(".am-data-export").off().on('click',function(e){e.preventDefault();AmCharts.Editor.modal({remote:AmCharts.Editor.CONSTANT.URL_BASE+'static/tpl/modal-data-export.tpl?'+ AmCharts.Editor.CONSTANT.RND_KEY});});AmCharts.Editor.current.rendered.push('editor');}
if(AmCharts.Editor.current.chart.chart_id&&AmCharts.Editor.current.tpl.loaded){AmCharts.Editor.init(AmCharts.Editor.current.cfg);}});jQuery(window).on('changed.am.user.badge',function(){if(AmCharts.Editor.current.section=='editor'){}});